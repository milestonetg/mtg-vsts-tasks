{
  "$schema": "https://raw.githubusercontent.com/Microsoft/vsts-task-lib/master/tasks.schema.json",
  "id": "807e40e0-4fa7-11e7-9a75-2966c46aa703",
  "name": "MtgDartTools",
  "friendlyName": "MTG Dart Tools",
  "description": "A build task for building and testing Dart packages.",
  "helpMarkDown": "Uses build_runner to build packages. Dart packages must be compatible with Dart 2.x.",
  "author": "Milestone",
  "category": "Utility",
  "runsOn": [
    "Agent"
  ],
  "demands": [],
  "version": {
    "Major": 1,
    "Minor": 0,
    "Patch": 36
  },
  "minimumAgentVersion": "1.95.0",
  "instanceNameFormat": "MtgDartTools $(message)",
  "groups": [
    {
      "name": "sdkDownloadOptions",
      "displayName": "SDK Download Options",
      "isExpanded": true,
      "visibleRule": "action = downloadSdk"
    },
    {
      "name": "sourceOptions",
      "displayName": "Source Options",
      "isExpanded": true,
      "visibleRule": "action != downloadSdk"
    },
    {
      "name": "buildOptions",
      "displayName": "Build Options",
      "isExpanded": true,
      "visibleRule": "action = build"
    },
    {
      "name": "sdkOptions",
      "displayName": "SDK Options",
      "isExpanded": false,
      "visibleRule": "action != downloadSdk"
    },
    {
      "name": "logging",
      "displayName": "Logging",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "action",
      "type": "pickList",
      "label": "Action",
      "defaultValue": "build",
      "required": true,
      "helpMarkDown": "The Dart-related action to be ran.",
      "options": {
        "downloadSdk": "Download SDK",
        "get": "Get Dependencies",
        "build": "Build"
      },
      "properties": {
        "EditableOptions": "False"
      }
    },
    {
      "name": "sourcePath",
      "type": "filePath",
      "label": "Source Path",
      "groupName": "sourceOptions",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Path to the Dart package (should be the directory containing pubspec.yaml)."
    },
    {
      "name": "sdkPath",
      "type": "filePath",
      "label": "SDK Path",
      "groupName": "sdkOptions",
      "defaultValue": "$(Agent.BuildDirectory)/dart-sdk",
      "required": true,
      "helpMarkDown": "Path to the Dart SDK (root directory, not the bin folder)."
    },
    {
      "name": "sdkDestinationPath",
      "type": "filePath",
      "label": "SDK Destination Path",
      "groupName": "sdkDownloadOptions",
      "defaultValue": "$(Agent.BuildDirectory)",
      "required": true,
      "helpMarkDown": "Path to download the Dart SDK to (a folder named 'dart-sdk' will be created at this path)."
    },
    {
      "name": "sdkChannel",
      "type": "pickList",
      "label": "SDK Channel",
      "groupName": "sdkDownloadOptions",
      "defaultValue": "stable",
      "required": true,
      "helpMarkDown": "Which SDK release channel to use.",
      "options": {
        "stable": "Stable",
        "dev": "Dev"
      }, 
      "properties": {
        "EditableOptions": "True"
      }
    },
    {
      "name": "sdkVersion",
      "type": "string",
      "label": "SDK Version",
      "groupName": "sdkDownloadOptions",
      "defaultValue": "2.0.0",
      "required": true,
      "helpMarkDown": "Which version of the Dart SDK to download (note: this task will not work with 1.x versions)."
    },
    {
      "name": "sdkPlatform",
      "type": "pickList",
      "label": "SDK Platform",
      "groupName": "sdkDownloadOptions",
      "defaultValue": "windows",
      "required": true,
      "helpMarkDown": "Which platform version of the Dart SDK to download.",
      "options": {
        "windows": "Windows",
        "linux": "Linux",
        "macos": "Mac OS"
      },
      "properties": {
        "EditableOptions": "True"
      }
    },
    {
      "name": "sdkArchitecture",
      "type": "pickList",
      "label": "SDK Architecture",
      "groupName": "sdkDownloadOptions",
      "defaultValue": "x64",
      "required": true,
      "helpMarkDown": "Which architecture of the Dart SDK to download.",
      "options": {
        "x86": "x86",
        "x64": "x64",
        "ia32": "ia32",
        "arm": "arm",
        "arm64": "arm64"
      },
      "properties": {
        "EditableOptions": "True"
      }
    },
    {
      "name": "release",
      "type": "boolean",
      "label": "Release Mode",
      "groupName": "buildOptions",
      "defaultValue": true,
      "required": true,
      "helpMarkDown": "Whether the package should be built in release mode."
    },
    {
      "name": "config",
      "type": "string",
      "label": "Build Configuration",
      "groupName": "buildOptions",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "Which build.yaml file to use. If specified, build_runner will use `build.<name>.yaml`, where `<name>` is the value set here. If left blank, `build.yaml` will be used (if it exists)."
    },
    {
      "name": "destinationPath",
      "type": "filePath",
      "label": "Output Path",
      "groupName": "buildOptions",
      "defaultValue": "$(Build.ArtifactStagingDirectory)",
      "required": true,
      "helpMarkDown": "Path that will contain the build output."
    },
    {
      "name": "verbose",
      "type": "boolean",
      "label": "Verbose Logging",
      "groupName": "logging",
      "defaultValue": false,
      "required": true,
      "helpMarkDown": "Whether verbose logging should be used."
    }
  ],
  "execution": {
    "Node": {
      "target": "mtg-dart-tools.js",
      "argumentFormat":  ""
    }
  }
}