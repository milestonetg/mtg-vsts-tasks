{
  "$schema": "https://raw.githubusercontent.com/Microsoft/vsts-task-lib/master/tasks.schema.json",
  "id": "807e40e0-4fa7-11e7-9a75-2966c46aa703",
  "name": "MtgDartTools",
  "friendlyName": "MTG Dart Tools",
  "description": "Provides tasks for installing the Dart SDK as well as building and testing Dart packages.",
  "helpMarkDown": "Uses build_runner to build packages. Dart packages must be compatible with Dart 2.x.",
  "author": "Milestone",
  "category": "Utility",
  "runsOn": [
    "Agent"
  ],
  "demands": [],
  "version": {
    "Major": 2,
    "Minor": 0,
    "Patch": 2
  },
  "minimumAgentVersion": "2.0.0",
  "instanceNameFormat": "Dart",
  "groups": [
    {
      "name": "sdkDownloadOptions",
      "displayName": "SDK Download Options",
      "isExpanded": true,
      "visibleRule": "action = install"
    },
    {
      "name": "sourceOptions",
      "displayName": "Source Options",
      "isExpanded": true,
      "visibleRule": "action != install"
    },
    {
      "name": "buildOptions",
      "displayName": "Build Options",
      "isExpanded": true,
      "visibleRule": "action = build"
    },
    {
      "name": "logging",
      "displayName": "Logging",
      "isExpanded": false,
      "visibleRule": "action != install"
    }
  ],
  "inputs": [
    {
      "name": "action",
      "type": "pickList",
      "label": "Action",
      "defaultValue": "build",
      "required": true,
      "helpMarkDown": "The Dart-related action to be ran.",
      "options": {
        "install": "Install SDK",
        "get": "Get Dependencies",
        "build": "Build"
      },
      "properties": {
        "EditableOptions": "False"
      }
    },
    {
      "name": "sourcePath",
      "type": "filePath",
      "label": "Source Path",
      "groupName": "sourceOptions",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Path to the Dart package (should be the directory containing pubspec.yaml)."
    },
    {
      "name": "sdkChannel",
      "type": "pickList",
      "label": "SDK Channel",
      "groupName": "sdkDownloadOptions",
      "defaultValue": "stable",
      "required": false,
      "helpMarkDown": "Which SDK release channel to use.",
      "options": {
        "stable": "Stable",
        "beta": "Beta",
        "dev": "Dev"
      }, 
      "properties": {
        "EditableOptions": "True"
      }
    },
    {
      "name": "sdkVersion",
      "type": "string",
      "label": "SDK Version",
      "groupName": "sdkDownloadOptions",
      "defaultValue": "2.8.4",
      "required": true,
      "helpMarkDown": "Which version of the Dart SDK to download (note: this task will not work with 1.x versions)."
    },
    {
      "name": "release",
      "type": "boolean",
      "label": "Release Mode",
      "groupName": "buildOptions",
      "defaultValue": true,
      "required": true,
      "helpMarkDown": "Whether the package should be built in release mode."
    },
    {
      "name": "lowResourcesMode",
      "type": "boolean",
      "label": "Low Resources Mode",
      "groupName": "buildOptions",
      "defaultValue": false,
      "required": false,
      "helpMarkDown": "Reduce the amount of memory consumed by the build process. This will slow down builds but allow them to progress in resource constrained environments."
    },
    {
      "name": "config",
      "type": "string",
      "label": "Build Configuration",
      "groupName": "buildOptions",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "Which build.yaml file to use. If specified, build_runner will use `build.<name>.yaml`, where `<name>` is the value set here. If left blank, `build.yaml` will be used (if it exists)."
    },
    {
      "name": "buildInputFolder",
      "type": "string",
      "label": "Package Folder To Build",
      "groupName": "buildOptions",
      "required": false,
      "defaultValue": "",
      "helpMarkDown": "The specific package folder to build (e.g. 'web'). If specified, only the given folder will be built, if empty then all valid package directories to build will be built."
    },
    {
      "name": "destinationPath",
      "type": "filePath",
      "label": "Output Path",
      "groupName": "buildOptions",
      "defaultValue": "$(Build.ArtifactStagingDirectory)",
      "required": true,
      "helpMarkDown": "Path that will contain the build output."
    },
    {
      "name": "verbose",
      "type": "boolean",
      "label": "Verbose Logging",
      "groupName": "logging",
      "defaultValue": false,
      "required": true,
      "helpMarkDown": "Whether verbose logging should be used."
    }
  ],
  "execution": {
    "Node": {
      "target": "mtg-dart-tools.js",
      "argumentFormat":  ""
    }
  }
}